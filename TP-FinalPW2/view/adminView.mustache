<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Estadísticas del Juego</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-light">
<div class="container py-4">
    <div class="d-flex justify-content-end">
        <a class="btn btn-dark" href="/login/logout">Cerrar Sesión</a>
    </div>

    <h1 class="text-center text-primary mt-2 mb-4">Preguntastico</h1>
    <h3 class="text-center text-secundary mt-2 mb-4">Estadísticas del Juego</h3>
    <div class="mb-4 text-center">
        <form id="filtro" action="/admin" method="POST">
            <label for="filtro" class="form-label fw-bold">Filtrar por:</label>
            <select id="filtro" class="form-select w-auto d-inline-block" name="filtro" onchange="document.getElementById('filtro').submit()">
                <option selected disabled hidden>Seleccionar..</option>
                <option value="dia" {{#filtro_dia}}selected{{/filtro_dia}}>Día</option>
                <option value="semana" {{#filtro_semana}}selected{{/filtro_semana}}>Semana</option>
                <option value="mes" {{#filtro_mes}}selected{{/filtro_mes}}>Mes</option>
                <option value="anio" {{#filtro_anio}}selected{{/filtro_anio}}>Año</option>
            </select>
        </form>
    </div>
    <div class="row text-center mb-4">
        <div class="col-md-4">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h5 class="card-title">Jugadores totales</h5>
                    <p class="card-text fs-4 fw-semibold">{{jugadores}}</p>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h5 class="card-title">Partidas jugadas</h5>
                    <p class="card-text fs-4 fw-semibold">{{partidas}}</p>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h5 class="card-title">Preguntas en el juego</h5>
                    <p class="card-text fs-4 fw-semibold">{{preguntas_totales}}</p>
                </div>
            </div>
        </div>
    </div>

    <div class="row text-center mb-4">
        <div class="col-md-4">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h5 class="card-title">Preguntas Creadas</h5>
                    <p class="card-text fs-4 fw-semibold">{{preguntas_creadas}}</p>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h5 class="card-title">Usuarios Nuevos por {{filtro}}</h5>
                    <p class="card-text fs-4 fw-semibold">{{usuarios_nuevos}}</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Gráficos -->
    <div class="row g-4 mt-2">
        <div class="col-md-6">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h5 class="card-title text-center">Porcentaje de Respuestas Correctas</h5>
                    <canvas id="respuestasCorrectas"></canvas>
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h5 class="card-title text-center">Usuarios por País</h5>
                    <canvas id="usuariosPorPais"></canvas>
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h5 class="card-title text-center">Usuarios por Sexo</h5>
                    <canvas id="usuariosPorSexo"></canvas>
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h5 class="card-title text-center">Usuarios por Edad</h5>
                    <canvas id="usuariosPorEdad"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>